function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(t,e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module&&"function"==typeof require?module.exports=e(require("jquery")):e(t.jQuery)}(this,function(i){"use strict";function e(t,e){return this.element=t,this.options=i.extend({},s,e),this.init()}var s={},o=i(document);e.prototype.init=function(){return this.$element=i(this.element),this.$select=this.$element.find('[data-component~="wcpw-steps-select"]'),this.$list=this.$element.find('[data-component~="wcpw-steps-list"]'),this.$modal=i('[data-component~="wcpw-step-modal"]'),this.$modalBody=this.$modal.find('[data-component~="wcpw-step-modal-body"]'),this.ajaxUrl=this.$element.data("ajax-url"),i.fn.sortable&&this.$list.sortable({items:'[data-component~="wcpw-steps-list-item"]'}),this},e.prototype.addItem=function(){var t=this.$list.children(),e=0;t.length&&t.each(function(){e=Math.max(e,Number(i(this).data("id")))}),e++;var s=this.$element.find('[data-component~="wcpw-steps-list-item-template"]').clone().appendTo(this.$list).attr("data-component","wcpw-steps-list-item").attr("data-id",e),n=s.find('[data-component~="wcpw-steps-list-item-settings"]'),a=s.find('[data-component~="wcpw-steps-list-item-clone"]');return s.find('[data-component~="wcpw-steps-list-item-name"]').text("#".concat(e)).end().find('[data-component~="wcpw-steps-list-item-id"]').attr("name","_steps_ids[".concat(e,"]")).attr("value",e),n.attr("data-settings",n.attr("data-settings").replace(/%STEP_ID%/g,e)),a.attr("data-settings",a.attr("data-settings").replace(/%STEP_ID%/g,e)),o.trigger("added.item.steps.wcpw",[this,a]),s},e.prototype.showModal=function(){return this.$modal.addClass("is-opened"),this},e.prototype.hideModal=function(){return this.$modal.removeClass("is-opened"),this},e.prototype.getSettings=function(t){var e=this,s=i.extend({},{action:"wcpwGetStepSettingsForm"},t);return i.get(this.ajaxUrl,s,function(t){e.$modalBody.html(t),e.showModal(),o.trigger("get.settings.item.steps.wcpw",[e,t])})},e.prototype.saveSettings=function(t){var e={action:"wcpwSaveStepSettings",post_id:t.attr("data-post-id"),step_id:t.attr("data-step-id"),values:t.serialize()};return i.post(this.ajaxUrl,e,null,"json")},e.prototype.cloneItem=function(t,e,s){var n={action:"wcpwCloneStepSettings",post_id:t,source_step:e,target_step:s};return i.post(this.ajaxUrl,n,null,"json")},e.prototype.removeItem=function(t){return this.$select.find('[value="'.concat(t.attr("data-id"),'"]')).removeClass("hidden"),t.remove(),o.trigger("removed.item.steps.wcpw",[this]),this},e.prototype.checkFromValidity=function(t){var e=!0;return 0===t.length||t.each(function(){"undefined"!==this.checkValidity&&(e=this.checkValidity())}),e},i.fn.wcpwSteps=function(t){return this.each(function(){i.data(this,"wcpw-steps")||i.data(this,"wcpw-steps",new e(this,t))})};function t(){return i('[data-component~="wcpw-steps"]').each(function(){return i(this).wcpwSteps()})}o.ready(t).on("ajaxComplete.wcpw init.steps.wcpw",t).on("click",'[data-component~="wcpw-steps-add"]',function(t){t.preventDefault();var e=i(this).closest('[data-component~="wcpw-steps"]');return e.data("wcpw-steps")?e.data("wcpw-steps").addItem():this}).on("click",'[data-component~="wcpw-steps-list-item-remove"]',function(t){t.preventDefault();var e=i(this),s=e.closest('[data-component~="wcpw-steps"]');return s.data("wcpw-steps")?s.data("wcpw-steps").removeItem(e.closest('[data-component~="wcpw-steps-list-item"]')):this}).on("click",'[data-component~="wcpw-steps-list-item-settings"]',function(t){t.preventDefault();var e=i(this),s=e.closest('[data-component~="wcpw-steps"]');return e.addClass("is-loading"),s.data("wcpw-steps")?s.data("wcpw-steps").getSettings(e.data("settings")).always(function(){return e.removeClass("is-loading")}):this}).on("click",'[data-component~="wcpw-steps-list-item-clone"]',function(t){t.preventDefault();var e=i(this),s=e.closest('[data-component~="wcpw-steps"]');if(e.addClass("is-loading"),s.data("wcpw-steps")){var n=s.data("wcpw-steps").addItem();return s.data("wcpw-steps").cloneItem(e.data("settings").post_id,e.data("settings").step_id,n.data("id")).always(function(){return e.removeClass("is-loading")})}return this}).on("submit",'[data-component~="wcpw-step-settings-form"]',function(t){var e=i(this),s=i('[data-component~="wcpw-steps"]');if(s.data("wcpw-steps")){if(!s.data("wcpw-steps").checkFromValidity(e))return e.find('[data-component~="wcpw-settings-group-content"]').addClass("is-visible"),this;t.preventDefault(),s.data("wcpw-steps").hideModal().saveSettings(e)}return this}).on("click",'[data-component~="wcpw-step-modal-close"]',function(t){t.preventDefault();var e=i('[data-component~="wcpw-steps"]');return e.data("wcpw-steps")&&e.data("wcpw-steps").hideModal(),this})});